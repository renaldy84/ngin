var sys = require('sys'), puts = sys.puts;
var dgram = require('dgram');
var ndns = require('../lib/ndns');
var server = ndns.createServer('udp4');
var client = ndns.createClient('udp4');

var DNS_PORT = 53;

server.on("request", function(req, res) {
    res.header.qr = 1;
    res.header.ra = 1;
    res.header.rd = 0;
    res.header.ancount = 3;
    res.header.nscount = 4;
    res.header.arcount = 5;
    res.addRR(req.q.name, 1, "IN", "SOA",
	      "hostmaster." + req.q.name,
	      "hostmaster." + req.q.name,
	      1, 2, 3, 4, 5);
    res.addRR(req.q.name, 1, "IN", "TXT", "Hello World");
    res.addRR(req.q.name, 1, "IN", "MX", 10, "mail." + req.q.name);
    res.addRR(req.q.name, 1, "IN", "NS", "ns1." + req.q.name);
    res.addRR(req.q.name, 2, "IN", "NS", "ns2." + req.q.name);
    res.addRR(req.q.name, 3, "IN", "NS", "ns3." + req.q.name);
    res.addRR(req.q.name, 4, "IN", "NS", "ns4." + req.q.name);
    res.addRR("mail." + req.q.name, 1, "IN", "A", "127.0.0.1");
    res.addRR("ns1." + req.q.name, 1, "IN", "A", "127.0.0.1");
    res.addRR("ns2." + req.q.name, 2, "IN", "A", "127.0.0.2");
    res.addRR("ns3." + req.q.name, 3, "IN", "A", "127.0.0.3");
    res.addRR("ns4." + req.q.name, 4, "IN", "A", "127.0.0.4");
    res.send();
});

server.bind(53);
