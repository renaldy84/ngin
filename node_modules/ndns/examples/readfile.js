var sys = require('sys'), puts = sys.puts;
var dgram = require('dgram');
var ndns = require('../lib/ndns');
var server = ndns.createServer('udp4');
var client = ndns.createClient('udp4');

var DNS_PORT = 53;

server.on("request", function(req, res) {
    var name = req.q[0].name;
    var filename = '/etc/' + name;
    res.setHeader(req.header);
    res.q.add(req.q[0]);
    require('fs').readFile(filename, function(err, data) {
	if (err) throw err;
	res.header.ancount = 1;
	res.addRR(name, 2, "IN", "TXT", data);
	res.send();
    });
});

server.bind(53);
